Version 1
SubGoalCombiner SGC_AND
INITSECTION

KBSECTION
// For debugging TODO: remove
IF
CastedSpell(_Character, "PPMeterShowOff", _, _, _)
THEN
RemoveStatus(_Character, "PPMeter_CombatDamageFirst", _Character);
RemoveStatus(_Character, "PPMeter_CombatDamageSecond", _Character);
ApplyStatus(_Character, "PPMeter_CombatDamageFirst", 1404.0, 1, _Character); // 234 * 6
ApplyStatus(_Character, "PPMeter_CombatDamageSecond", 4068.0, 1, _Character);  // 678 * 6



//REGION Add Show Off spell to each party member if it does not have it
IF
CastedSpell(_Character, _, _, _, _)
AND
DB_PartyMembers((CHARACTER)_Character)
AND
HasSpell(_Character, "PPMeterShowOff", 0)
THEN
AddSpell(_Character, "PPMeterShowOff", 1);
DebugText(_Character, "I can Show Off now!");
//END_REGION

//REGION ShowOff spell casted
IF
CastedSpell(_Character, "PPMeterShowOff", _, _, _)
AND
DB_PPMeter_DataInteger((CHARACTER)_Character, _Lifetime, "Damage", _Val1)
AND
DB_PPMeter_DataInteger((CHARACTER)_Character, _Lifetime, "RoundsCount", _Val2)
AND
Concatenate(_Lifetime, " Rounds: ", _msg1)
AND
ConcatenateInteger(_msg1, _Val2, _msg2)
AND
Concatenate(_msg2, " Damage: " , _msg3)
AND
ConcatenateInteger(_msg3, _Val1, _msg)
AND
IntegerToReal(_Val1, _Val1Real)
THEN
DebugText(_Character, _msg);



IF
CastedSpell(_Character, "PPMeterShowOff", _, _, _)
AND
NOT DB_PPMeter_DataInteger((CHARACTER)_Character, _, "Damage", _)
THEN
DebugText(_Character, "I need to hit someone first!");

IF
CastedSpell(_Character, "PPMeterShowOff", _, _, _)
AND
NOT DB_PPMeter_DataInteger((CHARACTER)_Character, _, "RoundsCount", _)
THEN
DebugText(_Character, "I need to end turn first!");
//END_REGION
EXITSECTION

ENDEXITSECTION
ParentTargetEdge "Start"
