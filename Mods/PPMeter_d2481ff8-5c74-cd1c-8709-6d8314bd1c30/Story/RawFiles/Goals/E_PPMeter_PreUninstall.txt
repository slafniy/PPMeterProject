Version 1
SubGoalCombiner SGC_AND
INITSECTION
// DB records to remove
// DB_PPMeter_Lifetime(_Val1)
// DB_PPMeter_StatsType(_Val1)
// DB_PPMeter_CalculatedStats(_Val1, _Val2)
// DB_PPMeter_ResourceNames(_Val1, _Val2, _Val3)
// DB_PPMeter_DataReal(_Val1, _Val2, _Val3, _Val4)
// DB_PPMeter_EventsCounter(_Val1, _Val2)
// DB_PPMeter_PreviousHP(_Val1, _Val2)
// DB_PPMeter_CurrentResourceBoost(_Val1, _Val2, _Val3, _Val4, _Val5)
// DB_PPMeter_LevelGameplayStartedTimerMs(_Val1)
// DB_PPMeter_HealEvents(_Val1, _Val2, _Val3)
// DB_PPMeter_HealEventTimers(_Val1, _Val2, _Val3)
// DB_PPMeter_HealEventTimerValueMs(_Val1)
KBSECTION
//REGION // handle LevelGameplayStarted - Add Shout_PPMeterWipe spell after timeout
IF
TimerFinished("PPMeter_TimerLevelGameplayStarted")
AND
DB_PartyMembers(_Character)
AND
GetHostCharacter(_Character)
AND
GUIDToString(_Character, _onlyOnceStr1)
AND
Concatenate(_onlyOnceStr1, "PPMeterWipeButtonAdd", _onlyOnceStr)
AND
QRY_OnlyOnce(_onlyOnceStr)
THEN
AddSpell(_Character, "Shout_PPMeterWipe", 1, 0);
//END_REGION


//REGION  // Process Shout_PPMeterWipe
IF
CastedSpell((CHARACTER)_Player, "Shout_PPMeterWipe", _, _, _)
THEN
DebugText(_Player, "Shout_PPMeterWipe cast!");
PROC_PPMeter_WipeAllData();

IF
CastedSpell((CHARACTER)_Player, "Shout_PPMeterWipe", _, _, _)
THEN
RemoveSpell(_Player, "Shout_PPMeterWipe", 0);
//END_REGION


//REGION // PROC_PPMeter_WipeAllData()
// Remove existing boosts first!
PROC
PROC_PPMeter_WipeAllData()
AND
DB_PPMeter_CurrentResourceBoost(_Character, _ResourceName, _Lifetime, _StatsType, _BoostString)
THEN
RemoveBoosts(_Character, _BoostString, 0, "", _Character);
NOT DB_PPMeter_CurrentResourceBoost(_Character, _ResourceName, _Lifetime, _StatsType, _BoostString);

PROC
PROC_PPMeter_WipeAllData()
AND
DB_PPMeter_Lifetime(_Val1)
THEN
NOT DB_PPMeter_Lifetime(_Val1);

PROC
PROC_PPMeter_WipeAllData()
AND
DB_PPMeter_StatsType(_Val1)
THEN
NOT DB_PPMeter_StatsType(_Val1);

PROC
PROC_PPMeter_WipeAllData()
AND
DB_PPMeter_CalculatedStats(_Val1, _Val2)
THEN
NOT DB_PPMeter_CalculatedStats(_Val1, _Val2);

PROC
PROC_PPMeter_WipeAllData()
AND
DB_PPMeter_ResourceNames(_Val1, _Val2, _Val3)
THEN
NOT DB_PPMeter_ResourceNames(_Val1, _Val2, _Val3);

PROC
PROC_PPMeter_WipeAllData()
AND
DB_PPMeter_DataReal(_Val1, _Val2, _Val3, _Val4)
THEN
NOT DB_PPMeter_DataReal(_Val1, _Val2, _Val3, _Val4);

PROC
PROC_PPMeter_WipeAllData()
AND
DB_PPMeter_EventsCounter(_Val1, _Val2)
THEN
NOT DB_PPMeter_EventsCounter(_Val1, _Val2);

PROC
PROC_PPMeter_WipeAllData()
AND
DB_PPMeter_PreviousHP(_Val1, _Val2)
THEN
NOT DB_PPMeter_PreviousHP(_Val1, _Val2);

PROC
PROC_PPMeter_WipeAllData()
AND
DB_PPMeter_CurrentResourceBoost(_Val1, _Val2, _Val3, _Val4, _Val5)
THEN
NOT DB_PPMeter_CurrentResourceBoost(_Val1, _Val2, _Val3, _Val4, _Val5);

PROC
PROC_PPMeter_WipeAllData()
AND
DB_PPMeter_LevelGameplayStartedTimerMs(_Val1)
THEN
NOT DB_PPMeter_LevelGameplayStartedTimerMs(_Val1);

PROC
PROC_PPMeter_WipeAllData()
AND
DB_PPMeter_HealEvents(_Val1, _Val2, _Val3)
THEN
NOT DB_PPMeter_HealEvents(_Val1, _Val2, _Val3);

PROC
PROC_PPMeterWipeAllData()
AND
DB_PPMeter_HealEventTimers(_Val1, _Val2, _Val3)
THEN
NOT DB_PPMeter_HealEventTimers(_Val1, _Val2, _Val3);

PROC
PROC_PPMeterWipeAllData()
AND
DB_PPMeter_HealEventTimerValueMs(_Val1)
THEN
NOT DB_PPMeter_HealEventTimerValueMs(_Val1);

//END_REGION
EXITSECTION

ENDEXITSECTION
ParentTargetEdge "Start"
